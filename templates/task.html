{% extends "base.html" %}

{% block title %}Task Details{% endblock %}


{% block content %}

<div id="homeTitleSpan">
    <!-- <h1 class="text-center mt-4" id="taskID">TSK-{{ task_number }} Details</h1> -->
</div>
<!-- <div class="row mt-4">
    <div class="col"></div>
    <div class="col-6">
        <div class="card shadow-lg homeCardTitle" id="dashboardCard">
            <div class="card-title">
                <h1 class="text-center mt-4" id="taskID">TSK-{{ task_number }} Details</h1>

            </div>
        </div>
    </div>
    <div class="col"></div>
</div> -->

<!-- ------------------------------------------------------- Task Details ---------------------------------------------------------- -->

<div class="container-fluid mt-3 bg" id="taskContainer">

    <!-- Side Bar -->
    <div class="col-2" id="sideBar"></div>
    <div class="co-8" id="task_details_col">

        <!-- Task Data-->

        <div class="card mt-5" style="width: auto">
            <h2 class="text-center mt-2" id="taskID">TSK-{{ task_number }} Details</h2>

            <div class="card-body my-2">

                <div class="container">

                    <form action="/update_task" method="POST">
                        <div class="row">
                            <div class=" col">
                                <span>Assigned To: </span>
                                {% if role == "Boss" %}
                                <select id="userChange" class="form-control" name="user_change">
                                    <option selected>{{ task_assigned_to }}</option>
                                    <option></option>
                                    {% for user in user_list %}
                                    <option>{{ user['first_name']}}</option>
                                    {% endfor %}
                                </select>
                                {% else %}
                                <input type="text" class="form-control" id="userAssignedTo"
                                    value="{{ task_assigned_to }}" readonly>
                                {% endif %}
                            </div>
                            <!-- <div class="col">
                                <span>Status: </span>
                                <select id="statusChange" class="form-control" name="status_change">
                                    <option selected>{{ task_status }}</option>
                                    <option>Open</option>
                                    <option>Pending</option>
                                    <option>Closed</option>
                                </select>
                            </div> -->
                            <div class="col">
                                <span>Priortiy: </span>
                                {% if role == "Boss" %}
                                <select id="priorityChange" class="form-control" name="priority_change">
                                    <option selected>{{ task_priority }}</option>
                                    <option>Low</option>
                                    <option>Medium</option>
                                    <option>High</option>
                                </select>
                                {% else %}
                                <input type="text" class="form-control" id="userPriority" value="{{ task_priority }}"
                                    readonly>
                                <!-- <select id="priorityChange" class="form-control" name="priority_change" readonly>
                                    <option selected>{{ task_priority }}</option>
                                <option>Low</option>
                                    <option>Medium</option>
                                    <option>High</option>
                                </select> -->
                                {% endif %}
                            </div>
                            <div class="col">
                                <span>Status: </span>
                                <select id="statusChange" class="form-control" name="status_change">
                                    <option selected>{{ task_status }}</option>
                                    <option>Open</option>
                                    <option>Pending</option>
                                    <option>Closed</option>
                                </select>
                            </div>
                        </div>

                        <br>

                        <div class="row">
                            <div class="col"></div>
                            <div class="col-4">
                                <span>Start Date: </span>
                                <input type="text" class="form-control" id="startDateChange" name="start_date_change"
                                    value="{{ task_start_date }}" readonly>
                            </div>
                            <div class=" col-4">
                                <span>Target Date: </span>
                                <input type="date" class="form-control" id="targetChange" name="target_change"
                                    value="{{ task_target_date }}">
                            </div>
                            <!-- <div class="col"></div> -->
                        </div>

                        <br>

                        <div class="row mt-3">
                            <div class="col-4 ">
                                <!-- <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">Task</span>
                                    </div>
                                    <textarea class="form-control" aria-label="With textarea" rows="1"
                                        placeholder="{{ task_label }}" readonly></textarea>
                                </div> -->
                                <span class="">Task</span>
                                <textarea class="form-control" aria-label="With textarea" rows="2"
                                    placeholder="{{ task_label }}" readonly></textarea>
                            </div>
                            <div class="col">
                                <!-- <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">Description</span>
                                    </div>
                                    <textarea class="form-control" aria-label="With textarea" rows="1"
                                        placeholder="{{ task_description }}" readonly></textarea>
                                </div> -->
                                <span class="">Description</span>
                                <textarea class="form-control" aria-label="With textarea" rows="2"
                                    placeholder="{{ task_description }}" readonly></textarea>
                            </div>
                        </div>
                </div>

                <button type="submit" id="taskUpdate" class="btn btn-secondary btn mt-4 float-right">Update</button>
                <input type="hidden" name="updateTaskNum" value="{{ task_number }}">
                </form>


            </div>
            <ul class="list-group list-group-flush">
                {% for comment in comment_list %}
                <form action="/remove_comment" method="POST">
                    <li class="list-group-item">
                        <div class="media">
                            <i class="far fa-comment-alt mr-2 mt-1"></i>
                            <div class="media-body">
                                <h5 class="mt-0">{{ comment['first_name'] }}</h5>
                                <p>{{ comment['comment']}}</p>

                                {% if user_name == comment['assigned_to'] %}
                                <button href="/remove_comment" type="submit" id="removeComment"
                                    class="btn btn-sm btn-outline-secondary float-right">Remove</button>
                                {% elif role == "Boss" %}
                                <button href="/remove_comment" type="submit" id="removeComment"
                                    class="btn btn-sm btn-outline-secondary float-right">Remove</button>
                                {%endif%}

                            </div>
                        </div>
                    </li>
                    <input type="hidden" name="commentText" value="{{ comment['comment']}}">
                    <input type="hidden" name="commentTaskNum" value="{{ task_number }}">
                </form>
                {% endfor %}
            </ul>

            <!-- Button trigger modal -->
            <div class="card-body">
                <a class="btn btn-secondary ml-auto d-block" role="button" type="button" id="addComment" href=""
                    aria-disabled="true" data-toggle="modal" data-target="#staticBackdrop">Add Comment</a>
            </div>
        </div>
    </div>
    <div class="col-2" id="sideBar"></div>
</div>

<!-- Modal for Comment-->
<div class="modal  fade" id="staticBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">Add Comment</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">

                <form action="/add_comment" method="POST" id="commentForm">
                    <div class="form-group">
                        <textarea class="form-control" id="exampleFormControlTextarea1" rows="3" name="newCommentText"
                            name="textArea" form="commentForm"></textarea>
                    </div>
                    <button type="submit" id="addComment" class="btn btn-secondary">Add</button>
                    <input type="hidden" name="task_number" value="{{ task_number }}" id="">
                </form>
            </div>
        </div>
    </div>
</div>

{% endblock %}